---
title: "Python注解"
author: "Qingyao Zhang"
date: "2021-06-09"
output: html_document
---
Python的各种参考文献中时有难懂之处，这未必是我们自己智商的原因，可能就是因为该文献写得太差（至少是某些内容、某一页、某一段、某一句写得太差）。另一种可能的解释是，我们自己*基础不好*，我们自己当前的水平与该文档目标受众之水平有差距。这就好比小学生看高中生的课本，智商再高也看不懂，因为知识的储备量有差距。这就好比铺铁路，我们储备的知识就是钢轨，如果钢轨还没有铺到目的地，我们的火车头再强劲也到不了目的地（不要抬扛说“火车没有钢轨也可以跑”）。导致这种差距的原因至少有两方面。一，文献作者写作时没能将自己的知识水平降到读者的知识水平，没能以读者可以理解的语言来写作。例如，作者声称这本书是写给本科生的，实际上大部分本科生都看不懂，这是作者的失职。二，读者没有找到与自己的知识水平相匹配的文献。换句话说，当你读一本书读不懂的时候，你应该考虑换一本书。

**试验**是学习代码的好方法。有些内容只可意会，不可言传，需要自己去体验（去做，去看，继而去思考）。代码有怎样的作用？应该怎么用？可以怎么用？对这些问题，我们可以多试。我把代码写成这样，跑一遍，看看效果怎么样；我把代码改成那样，跑一遍，看看效果如何变化。代码千变万化，没有人乐意将这千变万化全都解释给你听，因为那将是一件非常非常繁重和啰嗦的工作。我想，很多作者的心态大概是这样的吧——你有代码，你有软件，你自己去试啊，试一试不就知道了？（实际上我在写这篇文章的时候也产生了这样的想法。另外我还想到，如果我真的想学，就应该不厌其烦地去试；如果不愿如此麻烦，那只能说明我不想学。）一些鸡毛蒜皮的问题也没必要叨扰老师；要想把它搞明白，自己去试就好了。空想无益，不要脱离实践，要边做边想，在“做”中想，而不是在“坐”中想。

下文将对Python部分内容略做注解。

# 正则表达式(Regular Expression)

Regular Expression，即有规律的表达式。既然是**有规律的**，按说只要将**核心规律**讲清楚就可以了。

1. `\number`

```
import re
s = "It's a very good good idea"
re.sub(r'(\b\w+) \1', r'\1', s)
```
上述命令中`\1`表示：重复前面第1对括号中表达式所匹配的内容。注意此时括号中无空格。最终，`(\b\w+) \1`匹配得到的字符串为'good good'。我们将匹配得到的字符串称为一组（group），将该group中由括号括起来的部分字符串称为亚组（subgroup）。

```
re.findall(r'(\b\w+) (\b\w+)', s)
re.sub(r'(\b\w+) (\b\w+)', r'\1', s)
```
上述命令在字符串s中总计匹配得到3组字符串：`'s a','very good','good idea'`。表达式中前后两个`(\b\w+)`匹配得到的内容（两个亚组）是不同的。最终，第1个亚组替换了整个组：'s'替换了‘s a’，‘very’替换了‘very good’，'good'替换了‘good idea’。

```
re.sub(r'((\w+) )\1', r'\2', s)
```
上述命令`\2`表示：重复前面第2对括号中表达式所匹配的内容。注意此时括号中有空格。

2. `\`

这里需要区分三种字符：（1）原始字符，（2）转义字符，（3）元字符（正则表达式中的特殊字符）。

```
print('b \b')
print(r'b \b')
```

在上方的打印函数中，引号中的原始字符将被直接打印出来。我们可以使用`\`将原始字符转换为转义字符，例如`\b`将原始字符`b`转换为了退格（backspace；详见Python文档2.4.1）。如果想要让引号中的所有字符作为原始字符发挥作用(即让转义字符失效)，我们可以在引号前加上字符`r`或`R`。

```
re.sub(r'\bg', r'goooooo', s)
```

在上述命令中，引号前面有`r`声明了引号中为原始字符串，即引号中的`\b`不再是转义字符。但`re.sub()`将引号中的`\bg`识别为正则表达式，此时`\b`（boundary）作为元字符表示`\w`（`[a-zA-Z0-9_]）`与`\W`（`[^a-zA-Z0-9_]`）之间的边界，或`\w`与引号（`'`，`"`）之间的边界，而`\bg`表示所匹配的`g`的左侧无`[a-zA-Z0-9_]`这些字符（但可以有空格 ' " - & %等字符）。`s="It's a very good good idea"`是`re.sub()`操作的对象，`\bg`将匹配到两个`good`开头的`g`，因为`g`的左侧为空格（`g`属于`\w`，空格属于`\W`）。

但是，如果不用`r`声明原始字符串呢？那我们需要用`\\`声明元字符。即，

```
re.sub('\\bg', r'goooooo', s)
```

可以将上述命令理解为使用`\`将`\`转义为普通字符，之后`\b`将被识别为元字符发挥作用。也可以看出，转义字符的优先级高于元字符。

> 心情随笔：今天(2021-06-10)是个好日子。

<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可。